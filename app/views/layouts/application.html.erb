<!DOCTYPE html>
<html data-theme="light">
  <head>
    <title><%= content_for(:title) || "Currency Manager" %></title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= yield :head %>

    <%# Enable PWA manifest for installable apps (make sure to enable in config/routes.rb too!) %>
    <%#= tag.link rel: "manifest", href: pwa_manifest_path(format: :json) %>

    <link rel="icon" href="/icon.png" type="image/png">
    <link rel="icon" href="/icon.svg" type="image/svg+xml">
    <link rel="apple-touch-icon" href="/icon.png">

    <%# Includes all stylesheet files in app/assets/stylesheets %>
    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>
  </head>

  <body
    data-controller="sidebar app"
    data-sidebar-controller="sidebar"
    data-sidebar-active-class="is-active"
    class="bg-base-200"
  >

    <%= turbo_frame_tag :modal %>
    <!-- Sidebar -->
    <div class="drawer lg:drawer-open">
      <input id="sidebar-toggle" type="checkbox" class="drawer-toggle">
      <!-- Main content -->
      <div class="drawer-content">
        <!-- Navbar -->
        <div class="navbar bg-base-100 shadow-sm lg:hidden">
          <div class="flex-none">
            <label
              for="sidebar-toggle"
              class="btn btn-square btn-ghost"
              data-action="click->sidebar#open"
            >
              <%= icon("menu") %>
            </label>
          </div>
        </div>
        <!-- Page content -->
        <div class="min-h-screen bg-base-200">
          <div class="max-w-7xl mx-auto p-4">
            <!-- Loading overlay -->
            <div
              id="overlay"
              class="
                fixed inset-0 bg-black bg-opacity-50 z-50 hidden items-center justify-center
              "
            >
              <div class="text-center text-white">
                <span class="loading loading-spinner loading-lg"></span>
                <p class="mt-2"><%= t("loading") %></p>
              </div>
            </div>
            <!-- Page header -->
            <div class="mb-6">
              <h1 class="text-3xl font-bold text-base-content"><%= yield(:page_title) %></h1>
              <p class="text-base-content/70 mt-1"><%= yield(:page_description) %></p>
            </div>
            <!-- Page actions -->
            <div class="mb-6">
              <%= yield(:page_actions) %>
            </div>
            <!-- Main content -->
            <%= yield %>
          </div>
        </div>
      </div>
      <!-- Sidebar -->
      <div class="drawer-side shadow-sm">
        <label
          for="sidebar-toggle"
          class="drawer-overlay"
          data-action="click->sidebar#close"
        ></label>
        <aside class="w-72 min-h-full bg-base-100 shadow-xl">
          <ul class="menu w-full p-4">
            <li class="<%= controller_name == "metrics" ? "bordered" : "" %>">
              <%= link_to metrics_path,
              class: "#{controller_name == "metrics" ? "menu-active" : ""}" do %>
                <%= icon("home") %>
                <%= t("metrics.index.title") %>
              <% end %>
            </li>
            <li class="<%= controller_name == "transactions" ? "bordered" : "" %>">
              <%= link_to transactions_path,
              class: "#{controller_name == "transactions" ? "menu-active" : ""}" do %>
                <%= icon("coin") %>
                <%= Transaction.model_name.human(count: 2) %>
              <% end %>
            </li>

            <li class="<%= controller_name == "bank_balances" ? "bordered" : "" %>">
              <%= link_to banks_path,
              class: "#{controller_name == "banks" ? "menu-active" : ""}" do %>
                <%= icon("bank") %>
                <%= Bank.model_name.human(count: 2) %>
              <% end %>
            </li>
          </ul>
        </aside>
      </div>
    </div>
  </body>
</html>
